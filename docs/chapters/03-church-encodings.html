<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Chapter 3: Church Encodings (Or: Yes, No, and Maybe So)</title>
	<link rel="stylesheet" href="../css/hybrid-style.css">
</head>
<body>
	<div class="nav">
		<a href="../index.html">Home</a>
		<a href="../index.html#chapters">Chapters</a>
	</div>

	<h1>Chapter 3: Church Encodings (Or: Yes, No, and Maybe So)</h1>

	<p>How do you represent data using only functions? Alonzo Church discovered elegant encodings for booleans, numbers, and data structures. In this chapter, we'll learn how to represent booleans and build logic gates using pure lambda calculus.</p>

	<h2>Booleans as Choice Functions</h2>

	<p>In lambda calculus, a boolean is a function that <em>chooses</em> between two options:</p>

	<ul>
		<li><strong>True</strong> selects the first argument</li>
		<li><strong>False</strong> selects the second argument</li>
	</ul>

	<div class="info-box">
		<strong>True:</strong> λx.λy.x (returns first argument)<br>
		<strong>False:</strong> λx.λy.y (returns second argument)
	</div>

	<pre><code>const True = x => y => x
const False = x => y => y</code></pre>

	<div style="padding: 30px 0; margin: 30px 0;">
		<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px; max-width: 800px; margin: 0 auto;">
			<div style="background: white; padding: 30px; border-radius: 8px; border: 2px solid #28a745; text-align: center;">
				<div style="font-size: 28px; color: #28a745; font-family: Georgia, serif; margin-bottom: 15px; font-weight: bold;">True</div>
				<div style="font-family: 'Courier New', monospace; font-size: 14px; color: #666; margin-bottom: 20px;">λx.λy.x</div>
				<div style="margin: 25px 0;">
					<div style="display: flex; align-items: center; justify-content: center; gap: 10px; margin: 10px 0;">
						<div style="background: #d4edda; padding: 12px 20px; border-radius: 6px; border: 2px solid #28a745; font-family: 'Courier New', monospace; font-size: 14px;">
							"first"
						</div>
						<div style="font-size: 20px; color: #28a745;">✓</div>
					</div>
					<div style="display: flex; align-items: center; justify-content: center; gap: 10px; margin: 10px 0; opacity: 0.4;">
						<div style="background: #f8f9fa; padding: 12px 20px; border-radius: 6px; border: 2px solid #ccc; font-family: 'Courier New', monospace; font-size: 14px;">
							"second"
						</div>
						<div style="font-size: 20px;">✗</div>
					</div>
				</div>
				<div style="font-size: 13px; color: #666; margin-top: 20px; font-style: italic;">Selects first argument</div>
			</div>

			<div style="background: white; padding: 30px; border-radius: 8px; border: 2px solid #dc3545; text-align: center;">
				<div style="font-size: 28px; color: #dc3545; font-family: Georgia, serif; margin-bottom: 15px; font-weight: bold;">False</div>
				<div style="font-family: 'Courier New', monospace; font-size: 14px; color: #666; margin-bottom: 20px;">λx.λy.y</div>
				<div style="margin: 25px 0;">
					<div style="display: flex; align-items: center; justify-content: center; gap: 10px; margin: 10px 0; opacity: 0.4;">
						<div style="background: #f8f9fa; padding: 12px 20px; border-radius: 6px; border: 2px solid #ccc; font-family: 'Courier New', monospace; font-size: 14px;">
							"first"
						</div>
						<div style="font-size: 20px;">✗</div>
					</div>
					<div style="display: flex; align-items: center; justify-content: center; gap: 10px; margin: 10px 0;">
						<div style="background: #f8d7da; padding: 12px 20px; border-radius: 6px; border: 2px solid #dc3545; font-family: 'Courier New', monospace; font-size: 14px;">
							"second"
						</div>
						<div style="font-size: 20px; color: #dc3545;">✓</div>
					</div>
				</div>
				<div style="font-size: 13px; color: #666; margin-top: 20px; font-style: italic;">Selects second argument</div>
			</div>
		</div>
	</div>

	<p>Notice that True is exactly the K combinator from Chapter 1! False is similar but returns the second argument instead.</p>

	<h3>Examples</h3>

	<div id="demo-bool-basic"></div>

	<h3>Booleans in JavaScript</h3>

	<p>You're already using Church booleans every time you write a ternary operator!</p>

	<pre><code>// JavaScript ternary
const result = condition ? thenValue : elseValue;

// This is Church boolean selection!
// condition selects between two values
// True selects first (then), False selects second (else)

// Examples you write every day:
const status = isLoggedIn ? 'Welcome!' : 'Please log in';
const value = userInput || DEFAULT_VALUE;  // Short-circuit OR
const safeName = user && user.name;        // Short-circuit AND</code></pre>

	<p><strong>Short-circuit evaluation</strong> is the Church boolean pattern:</p>

	<pre><code>// || returns first truthy value (like OR choosing)
const name = userName || guestName || 'Anonymous';

// && returns first falsy value, or last value (like AND choosing)
const greeting = isLoggedIn && user && `Hello, ${user.name}!`;

// Nullish coalescing is even more explicit
const value = userValue ?? defaultValue;</code></pre>

	<h2>The If Conditional</h2>

	<p>Since booleans are already choice functions, conditionals are trivial:</p>

	<pre><code>const If = b => x => y => b(x)(y)</code></pre>

	<p>If takes a boolean <code>b</code> and two values. It applies the boolean to both values, letting the boolean choose which one to return.</p>

	<div id="demo-if-true"></div>
	<div id="demo-if-false"></div>

	<h3>If Statements Everywhere</h3>

	<p>The Church boolean If pattern appears constantly in JavaScript:</p>

	<pre><code>// Traditional if statement
if (condition) {
	doThen();
} else {
	doElse();
}

// Ternary (Church boolean!)
const result = condition ? doThen() : doElse();

// React conditional rendering - pure Church booleans!
{isLoggedIn ? <Dashboard /> : <Login />}
{hasError && <ErrorMessage />}  // AND pattern
{data || <Loading />}            // OR pattern

// Function calls
const handler = condition ? handleSuccess : handleError;
handler(data);

// Object property selection
const theme = darkMode ? darkTheme : lightTheme;
const color = theme.primary;</code></pre>

	<p>Every time you conditionally render in React, you're using Church encodings! The component tree is built by boolean choice functions.</p>

	<h2>Logic Operators</h2>

	<p>We can build all logic gates using only our boolean encoding!</p>

	<h3>AND</h3>

	<p>AND returns True only if both arguments are True:</p>

	<pre><code>const And = x => y => x(y)(x)</code></pre>

	<p>Think about it: if <code>x</code> is True, return <code>y</code> (the second determines the result). If <code>x</code> is False, return <code>x</code> (False).</p>

	<div id="demo-and-table"></div>

	<h3>OR</h3>

	<p>OR returns True if either argument is True:</p>

	<pre><code>const Or = x => y => x(x)(y)</code></pre>

	<p>If <code>x</code> is True, return <code>x</code> (True). If <code>x</code> is False, return <code>y</code> (the second determines the result).</p>

	<div id="demo-or-table"></div>

	<h3>NOT</h3>

	<p>NOT flips the boolean by swapping which argument gets returned:</p>

	<pre><code>const Not = b => x => y => b(y)(x)</code></pre>

	<p>Instead of <code>b(x)(y)</code>, we do <code>b(y)(x)</code> - the arguments are flipped!</p>

	<div id="demo-not"></div>

	<div style="padding: 30px 0; margin: 30px 0;">
		<div style="text-align: center; margin-bottom: 30px; font-size: 16px; color: #666; font-weight: 600;">
			Logic Gates Flow
		</div>
		<div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 30px; max-width: 1000px; margin: 0 auto;">
			<!-- AND -->
			<div style="background: white; padding: 25px; border-radius: 8px; border: 2px solid #6c5ce7;">
				<div style="text-align: center; font-weight: bold; margin-bottom: 20px; color: #6c5ce7; font-size: 16px;">AND</div>
				<div style="font-family: 'Courier New', monospace; font-size: 12px; text-align: center; color: #666; margin-bottom: 15px;">λx.λy.x(y)(x)</div>
				<div style="background: #f8f9fa; padding: 15px; border-radius: 6px; margin: 15px 0;">
					<div style="font-size: 12px; margin: 8px 0;">
						<span style="color: #28a745; font-weight: bold;">T</span> AND <span style="color: #28a745; font-weight: bold;">T</span> → <span style="color: #28a745; font-weight: bold;">T</span>
					</div>
					<div style="font-size: 12px; margin: 8px 0;">
						<span style="color: #28a745; font-weight: bold;">T</span> AND <span style="color: #dc3545; font-weight: bold;">F</span> → <span style="color: #dc3545; font-weight: bold;">F</span>
					</div>
					<div style="font-size: 12px; margin: 8px 0;">
						<span style="color: #dc3545; font-weight: bold;">F</span> AND <span style="color: #28a745; font-weight: bold;">T</span> → <span style="color: #dc3545; font-weight: bold;">F</span>
					</div>
					<div style="font-size: 12px; margin: 8px 0;">
						<span style="color: #dc3545; font-weight: bold;">F</span> AND <span style="color: #dc3545; font-weight: bold;">F</span> → <span style="color: #dc3545; font-weight: bold;">F</span>
					</div>
				</div>
				<div style="font-size: 11px; color: #666; text-align: center; font-style: italic; margin-top: 10px;">Both must be True</div>
			</div>

			<!-- OR -->
			<div style="background: white; padding: 25px; border-radius: 8px; border: 2px solid #6c5ce7;">
				<div style="text-align: center; font-weight: bold; margin-bottom: 20px; color: #6c5ce7; font-size: 16px;">OR</div>
				<div style="font-family: 'Courier New', monospace; font-size: 12px; text-align: center; color: #666; margin-bottom: 15px;">λx.λy.x(x)(y)</div>
				<div style="background: #f8f9fa; padding: 15px; border-radius: 6px; margin: 15px 0;">
					<div style="font-size: 12px; margin: 8px 0;">
						<span style="color: #28a745; font-weight: bold;">T</span> OR <span style="color: #28a745; font-weight: bold;">T</span> → <span style="color: #28a745; font-weight: bold;">T</span>
					</div>
					<div style="font-size: 12px; margin: 8px 0;">
						<span style="color: #28a745; font-weight: bold;">T</span> OR <span style="color: #dc3545; font-weight: bold;">F</span> → <span style="color: #28a745; font-weight: bold;">T</span>
					</div>
					<div style="font-size: 12px; margin: 8px 0;">
						<span style="color: #dc3545; font-weight: bold;">F</span> OR <span style="color: #28a745; font-weight: bold;">T</span> → <span style="color: #28a745; font-weight: bold;">T</span>
					</div>
					<div style="font-size: 12px; margin: 8px 0;">
						<span style="color: #dc3545; font-weight: bold;">F</span> OR <span style="color: #dc3545; font-weight: bold;">F</span> → <span style="color: #dc3545; font-weight: bold;">F</span>
					</div>
				</div>
				<div style="font-size: 11px; color: #666; text-align: center; font-style: italic; margin-top: 10px;">At least one must be True</div>
			</div>

			<!-- NOT -->
			<div style="background: white; padding: 25px; border-radius: 8px; border: 2px solid #6c5ce7;">
				<div style="text-align: center; font-weight: bold; margin-bottom: 20px; color: #6c5ce7; font-size: 16px;">NOT</div>
				<div style="font-family: 'Courier New', monospace; font-size: 12px; text-align: center; color: #666; margin-bottom: 15px;">λb.λx.λy.b(y)(x)</div>
				<div style="background: #f8f9fa; padding: 15px; border-radius: 6px; margin: 15px 0;">
					<div style="font-size: 12px; margin: 8px 0; text-align: center;">
						NOT <span style="color: #28a745; font-weight: bold;">T</span> → <span style="color: #dc3545; font-weight: bold;">F</span>
					</div>
					<div style="font-size: 12px; margin: 8px 0; text-align: center;">
						NOT <span style="color: #dc3545; font-weight: bold;">F</span> → <span style="color: #28a745; font-weight: bold;">T</span>
					</div>
				</div>
				<div style="font-size: 11px; color: #666; text-align: center; font-style: italic; margin-top: 10px;">Flips the value</div>
			</div>
		</div>
	</div>

	<h2>Interactive Truth Tables</h2>

	<p>Explore how these logic operators work:</p>

	<div id="widget-logic-explorer"></div>

	<h2>Pairs as Data Structures</h2>

	<p>We can also encode data structures as functions. A Pair stores two values:</p>

	<pre><code>const Pair = a => b => f => f(a)(b)</code></pre>

	<p>A pair takes two values and returns a function that applies a selector function to both values.</p>

	<pre><code>const First = p => p(True)
const Second = p => p(False)</code></pre>

	<p>To extract values, we pass True (selects first) or False (selects second)!</p>

	<div style="padding: 30px 0; margin: 30px 0;">
		<div style="max-width: 700px; margin: 0 auto;">
			<div style="text-align: center; margin-bottom: 25px; font-size: 14px; color: #666; font-weight: 600;">
				Pairs Use Booleans as Selectors
			</div>
			<div style="background: white; padding: 30px; border-radius: 8px; border: 2px solid #6c5ce7;">
				<div style="text-align: center; margin-bottom: 25px;">
					<div style="font-family: 'Courier New', monospace; font-size: 16px; color: #666;">
						Pair(10)(20)
					</div>
				</div>
				<div style="display: flex; flex-direction: column; gap: 20px;">
					<div style="display: flex; align-items: center; gap: 15px;">
						<div style="background: #d4edda; padding: 12px 20px; border-radius: 6px; border: 2px solid #28a745; font-family: 'Courier New', monospace; font-size: 14px; min-width: 120px; text-align: center;">
							First
						</div>
						<div style="font-size: 20px; color: #6c5ce7;">→</div>
						<div style="flex: 1; font-size: 13px; color: #666;">
							Pass <span style="color: #28a745; font-weight: bold;">True</span> to select first value
						</div>
						<div style="background: white; padding: 12px 20px; border-radius: 6px; border: 2px solid #28a745; font-family: 'Courier New', monospace; font-size: 14px; font-weight: bold;">
							10
						</div>
					</div>
					<div style="display: flex; align-items: center; gap: 15px;">
						<div style="background: #f8d7da; padding: 12px 20px; border-radius: 6px; border: 2px solid #dc3545; font-family: 'Courier New', monospace; font-size: 14px; min-width: 120px; text-align: center;">
							Second
						</div>
						<div style="font-size: 20px; color: #6c5ce7;">→</div>
						<div style="flex: 1; font-size: 13px; color: #666;">
							Pass <span style="color: #dc3545; font-weight: bold;">False</span> to select second value
						</div>
						<div style="background: white; padding: 12px 20px; border-radius: 6px; border: 2px solid #dc3545; font-family: 'Courier New', monospace; font-size: 14px; font-weight: bold;">
							20
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<h3>Example</h3>

	<div id="demo-pair"></div>

	<h2>Interactive Pair Explorer</h2>

	<div id="widget-pair-explorer"></div>

	<div class="exercise-box">
		<h3>Exercises</h3>
		<ol>
			<li>What does <code>And(True)(True)</code> return?</li>
			<li>What does <code>Or(False)(False)</code> return?</li>
			<li>What does <code>Not(Not(True))</code> return?</li>
			<li>Can you write XOR using And, Or, and Not?</li>
			<li>What does <code>Pair(10)(20)(And)</code> do?</li>
		</ol>
	</div>

	<h2>Why This Matters</h2>

	<p>We've just proven that you can represent data and logic using only functions. No primitive types needed! This demonstrates that:</p>

	<ul>
		<li>Functions are universal computational tools</li>
		<li>Data and behavior can be unified</li>
		<li>Complex structures emerge from simple abstractions</li>
	</ul>

	<h2>Key Takeaways</h2>

	<ul>
		<li>Booleans are choice functions between two options</li>
		<li>True selects the first argument, False selects the second</li>
		<li>All logic operators can be built from this encoding</li>
		<li>Pairs store two values and use booleans as selectors</li>
		<li>Everything is just functions!</li>
	</ul>

	<div class="chapter-nav">
		<a href="02-combinators.html">← Chapter 2: Combinators</a>
		<a href="04-numerals.html">Chapter 4: Church Numerals →</a>
	</div>

	<script type="module">
		import { True, False, If, And, Or, Not, Pair, First, Second } from '../lib/lamb.js'
		import { toBoolean } from '../lib/utils.js'
		import { InteractiveDemo } from '../js/interactive.js'

		const demo = new InteractiveDemo()

		// Boolean demos
		demo.registerDemo('demo-bool-basic', () => {
			return `
				True("first")("second") = "${True("first")("second")}"<br>
				False("first")("second") = "${False("first")("second")}"
			`
		})

		demo.registerDemo('demo-if-true', () => {
			const result = If(True)("yes")("no")
			return `If(True)("yes")("no") = "${result}"`
		})

		demo.registerDemo('demo-if-false', () => {
			const result = If(False)("yes")("no")
			return `If(False)("yes")("no") = "${result}"`
		})

		// Logic demos
		demo.registerDemo('demo-and-table', () => {
			return `
				<table>
					<tr><th>A</th><th>B</th><th>And(A)(B)</th></tr>
					<tr><td>True</td><td>True</td><td>${toBoolean(And(True)(True))}</td></tr>
					<tr><td>True</td><td>False</td><td>${toBoolean(And(True)(False))}</td></tr>
					<tr><td>False</td><td>True</td><td>${toBoolean(And(False)(True))}</td></tr>
					<tr><td>False</td><td>False</td><td>${toBoolean(And(False)(False))}</td></tr>
				</table>
			`
		})

		demo.registerDemo('demo-or-table', () => {
			return `
				<table>
					<tr><th>A</th><th>B</th><th>Or(A)(B)</th></tr>
					<tr><td>True</td><td>True</td><td>${toBoolean(Or(True)(True))}</td></tr>
					<tr><td>True</td><td>False</td><td>${toBoolean(Or(True)(False))}</td></tr>
					<tr><td>False</td><td>True</td><td>${toBoolean(Or(False)(True))}</td></tr>
					<tr><td>False</td><td>False</td><td>${toBoolean(Or(False)(False))}</td></tr>
				</table>
			`
		})

		demo.registerDemo('demo-not', () => {
			return `
				Not(True) = ${toBoolean(Not(True))}<br>
				Not(False) = ${toBoolean(Not(False))}
			`
		})

		// Pair demo
		demo.registerDemo('demo-pair', () => {
			const myPair = Pair(10)(20)
			return `
				const myPair = Pair(10)(20)<br>
				First(myPair) = ${First(myPair)}<br>
				Second(myPair) = ${Second(myPair)}
			`
		})

		// Interactive widgets
		demo.registerWidget('widget-logic-explorer', {
			inputs: [
				{ name: 'a', label: 'A (0=False, 1=True)', type: 'number', default: 1, min: 0, max: 1 },
				{ name: 'b', label: 'B (0=False, 1=True)', type: 'number', default: 0, min: 0, max: 1 }
			],
			compute: ({ a, b }) => {
				const boolA = a === 1 ? True : False
				const boolB = b === 1 ? True : False
				return {
					'AND': toBoolean(And(boolA)(boolB)),
					'OR': toBoolean(Or(boolA)(boolB)),
					'NOT A': toBoolean(Not(boolA)),
					'NOT B': toBoolean(Not(boolB))
				}
			}
		})

		demo.registerWidget('widget-pair-explorer', {
			inputs: [
				{ name: 'first', label: 'First Value', type: 'number', default: 42, min: 0, max: 100 },
				{ name: 'second', label: 'Second Value', type: 'number', default: 99, min: 0, max: 100 }
			],
			compute: ({ first, second }) => {
				const pair = Pair(first)(second)
				return {
					'First(pair)': First(pair),
					'Second(pair)': Second(pair)
				}
			}
		})

		demo.runDemos()
		demo.setupWidgets()
	</script>
</body>
</html>
